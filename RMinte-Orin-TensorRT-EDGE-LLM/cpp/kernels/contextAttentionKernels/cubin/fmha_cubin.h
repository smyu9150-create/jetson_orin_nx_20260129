/*
 * SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
 * SPDX-License-Identifier: Apache-2.0
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

#pragma once

extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm80_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm80_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm80_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm86_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm86_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm86_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm87_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm87_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm87_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm89_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm89_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm89_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm100_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm100_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm100_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm101_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm101_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm101_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm120_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm120_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm120_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm121_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm121_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm121_cu_cubin[];

extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm80_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm80_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm80_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm86_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm86_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm86_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm87_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm87_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm87_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm89_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm89_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm89_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm100_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm100_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm100_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm101_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm101_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm101_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm101_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm120_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm120_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm120_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm121_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm121_cu_cubin[];
extern unsigned char cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm121_cu_cubin[];


extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm80_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm80_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm80_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm86_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm86_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm86_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm87_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm87_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm87_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm89_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm89_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm89_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm100_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm100_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm100_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm101_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm101_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm101_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm120_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm120_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm120_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm121_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm121_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm121_cu_cubin_len;

extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm80_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm80_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm80_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm86_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm86_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm86_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm87_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm87_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm87_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm89_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm89_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm89_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm100_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm100_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm100_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm101_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm101_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm101_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm120_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm120_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm120_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm121_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm121_cu_cubin_len;
extern uint32_t cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm121_cu_cubin_len;

namespace fmha_v2 {

enum Data_type
{
    DATA_TYPE_BOOL,
    DATA_TYPE_FP16,
    DATA_TYPE_FP32,
    DATA_TYPE_INT4,
    DATA_TYPE_INT8,
    DATA_TYPE_INT32,
    DATA_TYPE_BF16,
    DATA_TYPE_E4M3,
    DATA_TYPE_E5M2
};
    
constexpr int32_t kSM_70 = 70;
constexpr int32_t kSM_72 = 72;
constexpr int32_t kSM_75 = 75;
constexpr int32_t kSM_80 = 80;
constexpr int32_t kSM_86 = 86;
constexpr int32_t kSM_87 = 87;
constexpr int32_t kSM_89 = 89;
constexpr int32_t kSM_90 = 90;
constexpr int32_t kSM_100 = 100;
constexpr int32_t kSM_101 = 101;
constexpr int32_t kSM_120 = 120;
constexpr int32_t kSM_121 = 121;
 
static const struct FusedMultiHeadAttentionKernelMetaInfoV2
{
    Data_type mDataTypeIn;
    Data_type mDataTypeOut;
    unsigned int mS;
    unsigned int mStepQ;
    unsigned int mStepKV;
    unsigned int mD;
    unsigned int mDV;
    unsigned int mSageBlockSizeQ;
    unsigned int mSageBlockSizeK;
    unsigned int mSageBlockSizeV;
    unsigned int mSM;
    const unsigned char* mCubin;
    unsigned int mCubinSize;
    const char* mFuncName;
    unsigned int mSharedMemBytes;
    unsigned int mThreadsPerCTA;
    unsigned int mUnrollStep;
    int mAttentionMaskType;
    int mAttentionInputLayout;
    bool mInterleaved;
    bool mFlashAttention;
    bool mWarpSpecialization;
    bool mFP32Accumulation;
    bool mAlibiSupported;
    bool mTiled;
    bool mEnableAttnLogitSoftcapping;
    bool mReturnSoftmaxStats;
} sMhaKernelMetaInfosV2[] = {
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_80, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm80_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm80_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_64_causal_sm80_kernel_nl", 16384, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_80, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm80_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm80_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_128_causal_sm80_kernel_nl", 32768, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_80, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm80_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm80_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_qkv_128_causal_sm80_kernel_nl_tiled", 81920, 128, 64, 1, 0, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_86, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm86_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm86_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_64_causal_sm86_kernel_nl", 16384, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_86, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm86_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm86_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_128_causal_sm86_kernel_nl", 32768, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_86, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm86_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm86_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_qkv_128_causal_sm86_kernel_nl_tiled", 81920, 128, 64, 1, 0, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_89, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm89_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm89_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_64_causal_sm89_kernel_nl", 16384, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_89, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm89_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm89_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_128_causal_sm89_kernel_nl", 32768, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_89, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm89_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm89_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_qkv_128_causal_sm89_kernel_nl_tiled", 81920, 128, 64, 1, 0, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_87, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm87_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm87_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_64_causal_sm87_kernel_nl", 16384, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_87, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm87_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm87_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_128_causal_sm87_kernel_nl", 32768, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_87, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm87_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm87_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_qkv_128_causal_sm87_kernel_nl_tiled", 81920, 128, 64, 1, 0, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_100, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm100_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm100_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_64_causal_sm100_kernel_nl", 16384, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_100, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm100_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm100_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_128_causal_sm100_kernel_nl", 32768, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_100, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm100_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm100_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_qkv_128_causal_sm100_kernel_nl_tiled", 81920, 128, 64, 1, 0, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_101, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm101_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm101_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_64_causal_sm101_kernel_nl", 16384, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_101, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm101_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm101_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_128_causal_sm101_kernel_nl", 32768, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_101, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm101_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm101_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_qkv_128_causal_sm101_kernel_nl_tiled", 81920, 128, 64, 1, 0, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_120, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm120_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm120_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_64_causal_sm120_kernel_nl", 16384, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_120, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm120_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm120_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_128_causal_sm120_kernel_nl", 32768, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_120, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm120_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm120_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_qkv_128_causal_sm120_kernel_nl_tiled", 81920, 128, 64, 1, 0, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_121, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm121_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_64_sm121_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_64_causal_sm121_kernel_nl", 16384, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_121, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm121_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_qkv_128_sm121_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_qkv_128_causal_sm121_kernel_nl", 32768, 128, 64, 1, 0, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_121, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm121_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_qkv_128_sm121_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_qkv_128_causal_sm121_kernel_nl_tiled", 81920, 128, 64, 1, 0, false, true, false, false, true, true, false, true},

{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_80, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm80_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm80_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_causal_sm80_kernel_nl", 16384, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_80, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm80_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm80_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_causal_sm80_kernel_nl", 32768, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_80, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm80_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm80_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_causal_sm80_kernel_nl_tiled", 81920, 128, 64, 1, 1, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_86, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm86_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm86_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_causal_sm86_kernel_nl", 16384, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_86, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm86_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm86_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_causal_sm86_kernel_nl", 32768, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_86, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm86_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm86_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_causal_sm86_kernel_nl_tiled", 81920, 128, 64, 1, 1, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_87, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm87_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm87_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_causal_sm87_kernel_nl", 16384, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_87, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm87_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm87_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_causal_sm87_kernel_nl", 32768, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_87, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm87_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm87_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_causal_sm87_kernel_nl_tiled", 81920, 128, 64, 1, 1, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_89, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm89_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm89_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_causal_sm89_kernel_nl", 16384, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_89, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm89_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm89_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_causal_sm89_kernel_nl", 32768, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_89, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm89_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm89_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_causal_sm89_kernel_nl_tiled", 81920, 128, 64, 1, 1, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_100, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm100_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm100_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_causal_sm100_kernel_nl", 16384, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_100, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm100_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm100_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_causal_sm100_kernel_nl", 32768, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_100, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm100_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm100_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_causal_sm100_kernel_nl_tiled", 81920, 128, 64, 1, 1, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_101, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm101_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm101_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_causal_sm101_kernel_nl", 16384, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_101, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm101_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm101_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_causal_sm101_kernel_nl", 32768, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_101, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm101_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm101_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_causal_sm101_kernel_nl_tiled", 81920, 128, 64, 1, 1, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_120, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm120_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm120_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_causal_sm120_kernel_nl", 16384, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_120, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm120_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm120_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_causal_sm120_kernel_nl", 32768, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_120, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm120_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm120_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_causal_sm120_kernel_nl_tiled", 81920, 128, 64, 1, 1, false, true, false, false, true, true, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 64, 64, 0, 0, 0, kSM_121, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm121_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_sm121_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_64_causal_sm121_kernel_nl", 16384, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 32, 128, 128, 0, 0, 0, kSM_121, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm121_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_sm121_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_32_S_q_kv_128_causal_sm121_kernel_nl", 32768, 128, 64, 1, 1, false, true, false, false, true, false, false, true},
{ DATA_TYPE_FP16, DATA_TYPE_FP16, 0, 64, 128, 128, 128, 0, 0, 0, kSM_121, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm121_cu_cubin, cubin_fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_sm121_cu_cubin_len, "fmha_v2_flash_attention_fp16_64_128_S_q_kv_128_causal_sm121_kernel_nl_tiled", 81920, 128, 64, 1, 1, false, true, false, false, true, true, false, true}

};

} // fmha_v2